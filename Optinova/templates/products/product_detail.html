{% extends "admin_page/main.html" %}
{% load static %}
{% block title %}Product Details{% endblock %}

{% block content %}
<main class="main-wrap">
    <section class="content-main">
        {% if messages %}
        <div class="alert">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %}

        <div>
            <a href="{% url 'product_list' %}" class="btn btn-primary float-end">Back to Product Management</a>
        </div>

        <div class="content-header">
            <h2 class="content-title card-title">{{ product.name }}</h2>
        </div>

        <div class="card shadow-sm">
            <div class="card-body">
                <div class="row mb-50 mt-20 order-info-wrap">
                    <div class="col-md-12">
                        <article class="icontext align-items-start">
                            <i class="text-primary material-icons md-info"></i>
                            <div class="text">
                                <h6 class="mb-2">Product Information</h6>
                                <p class="mb-2">
                                    <strong>Name:</strong> {{ product.name }} <br>
                                    <strong>Category:</strong> {{ product.category.name }} <br>
                                    <strong>Description:</strong> {{ product.description }}
                                </p>
                                <a href="{% url 'edit_product' product.id %}" class="btn btn-primary btn-sm mt-3">Edit Product</a>
                            </div>
                        </article>
                    </div>
                </div>

                <!-- Loop through each variant -->
                <div class="row">
                    {% for variant in product.variants.all %}
                    <div class="col-md-6">
                        <div class="box shadow-sm bg-light p-4 rounded mb-4">
                            <h6 class="mb-4">Variant: {{ variant.color }}
                                <div class="custom-option" data-value="{{ variant.color }}" style="display: inline-block; margin-right: 10px;">
                                    <span class="color-circle" style="background-color: {{ variant.color|default:'#FFFFFF' }}; width: 20px; height: 20px; border-radius: 50%; display: inline-block;"></span>
                                </div>
                            </h6>
                            <p><strong>Price:</strong> {{ variant.price }} <br>
                               <strong>Stock:</strong> {{ variant.stock }} units</p>

                            <!-- Images for the current variant -->
                            <h6 class="mb-3">Images</h6>
                            <div class="row">
                                {% if variant.images.all %}
                                <p>Total images for this variant: {{ variant.images.count }}</p>

                                    {% for image in variant.images.all %}
                                    <div class="col-md-4 mb-3">
                                        <div class="image-card">
                                            <!-- Display image with proper styling -->
                                            <img src="{{ image.image.url }}" alt="{{ variant.name }}" class="img-fluid rounded mb-2" style="max-width: 100%; height: auto;">
                                        </div>
                                    </div>
                                    {% endfor %}
                                {% else %}
                                    <p class="text-muted text-center">No images available for this variant.</p>
                                {% endif %}
                            </div>
                            <!-- Actions for the variant -->
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </section>
</main>

<!-- Add custom styling -->
<style>
    .image-card {
        border: 1px solid #ddd;
        border-radius: 5px;
        overflow: hidden;
        position: relative;
    }
    .image-card:hover {
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
</style>

{% endblock content %}
